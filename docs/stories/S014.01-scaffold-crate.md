# Story: Scaffold claude-hooks Crate

**Story ID:** S014.01 **Epic:** [E014 - Claude Hooks Library](../epic/E014-claude-hooks-library.md) **Status:** Complete **Priority:** P0 **Estimated Points:** 1

## Description

As a developer, I want to create the basic crate structure for claude-hooks, So that I have a foundation for implementing the library with proper workspace integration.

## Context

This is the foundational story for E014. It creates the crate skeleton with minimal dependencies, adds it to the workspace, and verifies the build pipeline. All subsequent stories build on this scaffold.

The crate follows workspace patterns established by `claude-usage` (E011): same author, similar structure, consistent dependency patterns.

## Implementation Details

### Technical Approach

1. Create `crates/claude-hooks/` directory structure
2. Create `Cargo.toml` with author and metadata
3. Create placeholder `src/lib.rs` with module documentation
4. Add crate to workspace members in root `Cargo.toml`
5. Create `docs/` directory with design documents
6. Verify `cargo build -p claude-hooks` succeeds

### Files to Create

- `crates/claude-hooks/Cargo.toml` - Crate manifest
- `crates/claude-hooks/src/lib.rs` - Library entry point (placeholder)
- `crates/claude-hooks/docs/PRD.md` - Product requirements (exists, link only)
- `crates/claude-hooks/docs/architecture.md` - Architecture spec (exists, link only)
- `crates/claude-hooks/docs/design-draft.md` - Design decisions (exists, link only)

### Files to Modify

- `Cargo.toml` (workspace root) - Add `crates/claude-hooks` to members

### Dependencies

None (first story in epic)

## Acceptance Criteria

- [x] Given workspace root, when `cargo build -p claude-hooks` runs, then crate compiles successfully
- [x] Given crate structure, when `cargo check --workspace` runs, then no errors
- [x] Given crate metadata, when inspected, then author is `Pablo LION <36828324+PabloLION@users.noreply.github.com>`
- [x] Given crate description, when inspected, then it reads "Programmatic management of Claude Code hooks"
- [x] Given lib.rs, when opened, then it contains module documentation and placeholder function
- [x] Given workspace, when `cargo build --workspace` runs, then all crates compile

## Testing Requirements

- [x] `cargo build -p claude-hooks` succeeds
- [x] `cargo check --workspace` succeeds
- [x] `cargo test -p claude-hooks` succeeds (placeholder test passes)

## Out of Scope

- Implementing any functionality (subsequent stories)
- Adding production dependencies (added incrementally)
- Documentation beyond module-level doc comments

## Notes

### Cargo.toml (Initial)

```toml
[package]
name = "claude-hooks"
version = "0.1.0"
edition.workspace = true
rust-version.workspace = true
authors = ["Pablo LION <36828324+PabloLION@users.noreply.github.com>"]
description = "Programmatic management of Claude Code hooks"
license.workspace = true
repository.workspace = true
keywords = ["claude", "hooks", "settings", "anthropic"]
categories = ["development-tools", "config"]

[dependencies]
# Dependencies added in S014.02+

[dev-dependencies]
# Test dependencies added in S014.06
```

### Initial lib.rs

```rust
//! Programmatic management of Claude Code hooks
//!
//! This crate provides a library API to install, uninstall, and list hooks
//! in Claude Code's settings.json with atomic safety guarantees and
//! ownership tracking.
//!
//! # Platform Support
//!
//! - macOS: Supported
//! - Linux: Supported
//! - Windows: Not supported in v0.1 (deferred to v0.2+)
//!
//! # Scope Limitations (v0.1)
//!
//! - User scope only (`~/.claude/settings.json`)
//! - No multi-scope support (user/project/local)
//! - Library-only (no CLI binary)
//!
//! # Examples
//!
//! ```rust,ignore
//! use claude_hooks::{HookEvent, HookHandler, install};
//!
//! let handler = HookHandler {
//!     r#type: "command".to_string(),
//!     command: "/path/to/stop.sh".to_string(),
//!     matcher: String::new(),
//!     timeout: Some(600),
//!     r#async: None,
//! };
//!
//! install(HookEvent::Stop, handler, "acd")?;
//! ```

#![warn(missing_docs)]

/// Placeholder function - implementation in subsequent stories
pub fn placeholder() {
    // Implementation starts in S014.02
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_placeholder() {
        placeholder(); // Just verify it compiles
    }
}
```

### Workspace Root Update

Add to `Cargo.toml` workspace members:

```toml
[workspace]
members = [
    "crates/agent-console-dashboard",
    "crates/claude-usage",
    "crates/claude-hooks",  # Add this line
]
```

### Directory Structure

```text
crates/claude-hooks/
├── Cargo.toml
├── docs/
│   ├── PRD.md              # Product requirements
│   ├── architecture.md     # Technical architecture
│   └── design-draft.md     # Design decisions (36 decisions)
└── src/
    └── lib.rs              # Library entry point
```

### Validation Checklist

- [x] Crate compiles without warnings
- [x] Workspace build succeeds
- [x] Author field matches workspace convention
- [x] Module documentation is clear and concise
- [x] Placeholder test passes

## Dev Agent Record

**Implementation Date:** 2026-02-03
**Implementation Sequence:**

1. Created `crates/claude-hooks/src/` directory structure
2. Created `Cargo.toml` with metadata (author, description, keywords, categories)
3. Created `src/lib.rs` with module documentation, placeholder function, and basic test
4. Modified workspace root `Cargo.toml` to add `crates/claude-hooks` to members
5. Verified `cargo build -p claude-hooks` succeeds (0.60s)
6. Verified `cargo test -p claude-hooks` passes (1 test)
7. Verified `cargo check --workspace` succeeds (3.09s)
8. Verified `cargo build --workspace` succeeds (0.18s)

**Key Decisions:**

- Used explicit `edition = "2021"` and `rust-version = "1.77"` instead of workspace inheritance (pattern from `claude-usage`)
- Used author email `36828324+PabloLION@users.noreply.github.com` as specified in requirements
- Docs directory already exists from design phase, no creation needed
- Placeholder function includes doc comment for clarity on when implementation starts

**Files Changed:**

- Created: `crates/claude-hooks/Cargo.toml`
- Created: `crates/claude-hooks/src/lib.rs`
- Modified: `Cargo.toml` (workspace root)

## Commit Checkpoint

This story marks a commit checkpoint per implementation plan Phase 1. Commit message:

```text
feat: scaffold claude-hooks crate for hook management library

- Create crate structure with Cargo.toml and lib.rs
- Add to workspace members
- Include module documentation and placeholder
- Verify workspace builds successfully
```
