# Story: Publish to crates.io

**Story ID:** S011.06 **Epic:**
[E011 - Claude Usage Crate](../epic/E011-claude-usage-crate.md) **Status:** Done
**Priority:** P0 **Estimated Points:** 1

## Description

As a crate author, I want to publish claude-usage to crates.io, So that other
Rust developers can use it as a dependency and the name is registered.

## Context

Publishing to crates.io makes the crate available to the Rust ecosystem. This
story covers preparing the crate for publication, including metadata, README,
and the actual publish process. Name registration is an important goal.

## Implementation Details

### Technical Approach

1. Complete Cargo.toml metadata (authors, license, keywords, etc.)
2. Create README.md for the crate
3. Add LICENSE files (MIT + Apache-2.0)
4. Verify with `cargo publish --dry-run`
5. Publish with `cargo publish`

### Crate Metadata

```toml
[package]
name = "claude-usage"
version = "0.1.0"
edition = "2021"
rust-version = "1.74"
authors = ["Pablo LION <pablolion@example.com>"]
description = "Fetch Claude API usage data from Anthropic"
license = "MIT OR Apache-2.0"
repository = "https://github.com/PabloLION/agent-console-dashboard"
homepage = "https://github.com/PabloLION/agent-console-dashboard"
documentation = "https://docs.rs/claude-usage"
readme = "README.md"
keywords = ["claude", "anthropic", "usage", "api", "oauth"]
categories = ["api-bindings", "authentication"]
```

### Files to Create/Modify

- `crates/claude-usage/Cargo.toml` - Complete metadata
- `crates/claude-usage/README.md` - Crate documentation
- `crates/claude-usage/LICENSE-MIT` - MIT license
- `crates/claude-usage/LICENSE-APACHE` - Apache 2.0 license

### Dependencies

- [S011.05 - Typed Usage Response](./S011.05-typed-usage-response.md) - Crate
  must be functional before publishing

## Acceptance Criteria

- [ ] Given complete metadata, when `cargo publish --dry-run` runs, then no
      errors are reported
- [ ] Given valid crates.io token, when `cargo publish` runs, then crate is
      published
- [ ] Given published crate, when searched on crates.io, then `claude-usage`
      appears
- [ ] Given published crate, when docs.rs builds, then documentation is
      available

## Testing Requirements

- [ ] `cargo publish --dry-run` succeeds
- [ ] All public items have documentation
- [ ] README examples compile

## Out of Scope

- CI/CD automation for publishing (future enhancement)
- Changelog automation
- Version bumping automation

## Notes

### README.md Content

The README should include: title, features, usage example with rust code,
platform support table, requirements, and license (MIT OR Apache-2.0).

See the actual README.md file created during implementation for the full
content.

### Pre-Publish Checklist

1. [ ] All tests pass: `cargo test`
2. [ ] Clippy clean: `cargo clippy`
3. [ ] Docs build: `cargo doc --no-deps`
4. [ ] Dry run: `cargo publish --dry-run`
5. [ ] Version is 0.1.0 (initial release)
6. [ ] LICENSE files present
7. [ ] README is accurate

### Publishing Command

```bash
cd crates/claude-usage
cargo publish
```

### Post-Publish Verification

1. Check [crates.io/crates/claude-usage](https://crates.io/crates/claude-usage)
2. Check [docs.rs/claude-usage](https://docs.rs/claude-usage)
3. Test installation: `cargo add claude-usage` in a new project
