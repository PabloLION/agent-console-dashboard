# Story: Create Linux systemd Unit File

**Story ID:** S013.02 **Epic:**
[E013 - Deployment Infrastructure](../epic/E013-deployment-infrastructure.md)
**Status:** Draft **Priority:** P1 **Estimated Points:** 2

## Description

As a Linux user, I want a systemd unit file that runs the daemon as a user-level
service, So that the daemon starts automatically on login and restarts on
failure.

## Context

Linux uses systemd for service management. A user-level unit file installed in
`~/.config/systemd/user/` runs without root privileges. The daemon should start
on login (`WantedBy=default.target`), restart on failure with backoff
(`Restart=on-failure`, `RestartSec=5`).

## Implementation Details

### Technical Approach

1. Create a systemd user unit file with correct settings
2. Use `Type=simple` (daemon runs in foreground for systemd)
3. Configure restart-on-failure with 5-second delay
4. Include the unit file as a project resource

### Unit File

```ini
[Unit]
Description=Agent Console Dashboard Daemon
After=network.target

[Service]
Type=simple
ExecStart=/usr/local/bin/acd daemon
Restart=on-failure
RestartSec=5

[Install]
WantedBy=default.target
```

### Files to Create

- `resources/acd.service` — systemd user unit file

### Dependencies

- [E001 - Daemon Core Infrastructure](../epic/E001-daemon-core-infrastructure.md)
  — daemon binary must exist

## Acceptance Criteria

- [ ] Unit file passes `systemd-analyze verify`
- [ ] `systemctl --user enable acd` succeeds
- [ ] Daemon starts on login when enabled
- [ ] Daemon restarts after failure with 5-second delay
- [ ] `systemctl --user stop acd` cleanly stops the service
- [ ] `systemctl --user disable acd` removes auto-start

## Testing Requirements

- [ ] Manual test: `systemd-analyze verify` validates unit file
- [ ] Manual test: enable/start/stop/disable cycle
- [ ] Manual test: kill daemon process, verify restart after 5 seconds
- [ ] Manual test: re-login, verify daemon starts

## Out of Scope

- CLI install/uninstall command (see S013.03)
- System-level (root) service configuration
- Socket activation
- Journal log configuration
