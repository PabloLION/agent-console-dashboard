# Story: Implement Install/Uninstall CLI

**Story ID:** S013.03 **Epic:**
[E013 - Deployment Infrastructure](../epic/E013-deployment-infrastructure.md)
**Status:** Draft **Priority:** P2 **Estimated Points:** 3

## Description

As a user, I want to run `acd service install` and `acd service uninstall` to
register or remove the daemon as a system service, So that I don't need to
manually copy service files or run platform-specific commands.

## Context

S013.01 and S013.02 create the service files (launchd plist, systemd unit). This
story provides CLI commands that copy those files to the correct locations and
run the platform-specific registration commands.

## Implementation Details

### Technical Approach

1. Add `service` subcommand group to CLI with `install` and `uninstall` actions
2. Detect platform at runtime (`#[cfg(target_os)]`)
3. On install: copy service file to correct location, run registration command
4. On uninstall: stop service, remove service file
5. Print clear status messages for each step

### CLI Commands

```bash
acd service install     # Copy plist/unit file, register service
acd service uninstall   # Stop service, remove files
```

### Platform Behavior

| Action    | macOS                                      | Linux                                       |
| --------- | ------------------------------------------ | ------------------------------------------- |
| Install   | Copy plist to ~/Library/LaunchAgents, load | Copy unit to ~/.config/systemd/user, enable |
| Uninstall | Unload, remove plist                       | Disable, stop, remove unit file             |

### Files to Modify

- `crates/agent-console-dashboard/src/main.rs` — add `Service` subcommand with
  `Install` and `Uninstall` actions

### Files to Create

- `crates/agent-console-dashboard/src/service.rs` — platform-specific
  install/uninstall logic

### Dependencies

- [S013.01 - macOS launchd Plist](./S013.01-macos-launchd-plist.md) — plist file
  to install
- [S013.02 - Linux systemd Unit File](./S013.02-linux-systemd-unit-file.md) —
  unit file to install

## Acceptance Criteria

- [ ] `acd service install` copies service file to correct platform location
- [ ] `acd service install` registers/enables the service
- [ ] `acd service uninstall` stops and removes the service
- [ ] Clear success/error messages for each step
- [ ] Idempotent: running install twice doesn't error
- [ ] `cargo test --workspace` passes
- [ ] `cargo clippy --workspace` passes

## Testing Requirements

- [ ] Unit test: platform detection returns correct value
- [ ] Unit test: install path construction for macOS
- [ ] Unit test: install path construction for Linux
- [ ] Manual test: full install/uninstall cycle on macOS
- [ ] Manual test: full install/uninstall cycle on Linux

## Out of Scope

- Windows service management
- `acd service status` (use native `launchctl`/`systemctl` commands)
- Upgrading an existing service installation
